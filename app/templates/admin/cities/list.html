{% extends "admin/base.html" %}

{% block title %}Управление городами{% endblock %}

{% block active_cities %}active{% endblock %}

{% block breadcrumb %}
<a href="/admin/">Главная</a> › Города
{% endblock %}

{% block extra_styles %}
/* CITIES LIST ADMIN CSS */
.page-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:25px}
.page-title{font-size:28px;color:#333;font-weight:400}
.btn-add{padding:10px 20px;background:#417690;color:#fff;border:none;border-radius:4px;text-decoration:none;font-size:14px;transition:all .2s ease;display:inline-flex;align-items:center;gap:8px}
.btn-add:hover{background:#2e5a6e}
.alert{padding:12px 16px;border-radius:4px;margin-bottom:20px;font-size:14px}
.alert-success{background:#d4edda;color:#155724;border:1px solid #c3e6cb}
.alert-error{background:#f8d7da;color:#721c24;border:1px solid #f5c6cb}
.cities-table-wrapper{background:#fff;border:1px solid #ddd;border-radius:4px;overflow:hidden}
.cities-table{width:100%;border-collapse:collapse}
.cities-table thead{background:#f8f8f8;border-bottom:2px solid #ddd}
.cities-table th{padding:12px 15px;text-align:left;font-size:13px;font-weight:600;color:#666;text-transform:uppercase;letter-spacing:.5px}
.cities-table td{padding:12px 15px;border-bottom:1px solid #eee;font-size:14px;color:#333}
.cities-table tbody tr:hover{background:#f8f8f8}
.status-badge{padding:4px 12px;border-radius:12px;font-size:12px;font-weight:500}
.status-active{background:#d4edda;color:#155724}
.status-inactive{background:#f8d7da;color:#721c24}
.action-buttons{display:flex;gap:8px}
.btn-icon{padding:6px 10px;border:1px solid #ddd;background:#fff;border-radius:4px;cursor:pointer;transition:all .2s ease;color:#417690;text-decoration:none;font-size:14px}
.btn-icon:hover{background:#417690;color:#fff;border-color:#417690}
.btn-icon.delete{color:#dc3545}
.btn-icon.delete:hover{background:#dc3545;color:#fff;border-color:#dc3545}
.empty-state{padding:60px 20px;text-align:center;color:#999}
.empty-state i{font-size:48px;margin-bottom:20px;color:#ddd}
{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">Управление городами</h1>
    <a href="/admin/cities/add" class="btn-add">
        <i class="fas fa-plus"></i>
        Добавить город
    </a>
</div>

<!-- Success/Error messages -->
{% if request.query_params.get('success') == 'created' %}
<div class="alert alert-success">
    <i class="fas fa-check-circle"></i> Город успешно создан!
</div>
{% elif request.query_params.get('success') == 'updated' %}
<div class="alert alert-success">
    <i class="fas fa-check-circle"></i> Город успешно обновлен!
</div>
{% elif request.query_params.get('success') == 'deleted' %}
<div class="alert alert-success">
    <i class="fas fa-check-circle"></i> Город успешно удален!
</div>
{% elif request.query_params.get('error') %}
<div class="alert alert-error">
    <i class="fas fa-exclamation-circle"></i> {{ request.query_params.get('error') }}
</div>
{% endif %}

<!-- Cities Table -->
{% if cities %}
<div class="cities-table-wrapper">
    <table class="cities-table">
        <thead>
            <tr>
                <th style="width: 80px;">ID</th>
                <th>Название</th>
                <th>Slug</th>
                <th style="width: 120px;">Порядок</th>
                <th style="width: 120px;">Статус</th>
                <th style="width: 150px;">Действия</th>
            </tr>
        </thead>
        <tbody>
            {% for city in cities %}
            <tr>
                <td>{{ city.id }}</td>
                <td>{{ city.name }}</td>
                <td>{{ city.slug }}</td>
                <td>{{ city.sort_order }}</td>
                <td>
                    {% if city.is_active %}
                    <span class="status-badge status-active">
                        Активен
                    </span>
                    {% else %}
                    <span class="status-badge status-inactive">
                        Неактивен
                    </span>
                    {% endif %}
                </td>
                <td>
                    <div class="action-buttons">
                        <a href="/admin/cities/{{ city.id }}/edit" class="btn-icon" title="Редактировать">
                            <i class="fas fa-edit"></i>
                        </a>
                        <form method="post" action="/admin/cities/{{ city.id }}/delete" style="display: inline;"
                              onsubmit="return confirm('Вы уверены, что хотите удалить этот город?')">
                            <button type="submit" class="btn-icon delete" title="Удалить">
                                <i class="fas fa-trash"></i>
                            </button>
                        </form>
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<div class="cities-table-wrapper">
    <div class="empty-state">
        <i class="fas fa-city"></i>
        <h3>Городов пока нет</h3>
        <p>В системе еще не добавлено ни одного города</p>
    </div>
</div>
{% endif %}
{% endblock %}
